@page
@model Vision.Pages.StoreListModel
@{
}
@*<div class="swiper-container swiper-theme shadow-swiper " data-swiper-options="{
     'spaceBetween': 20,
     'slidesPerView': 2,
     'breakpoints': {
         '576': {
             'slidesPerView': 3
         },
         '768': {
             'slidesPerView': 4
         },
         '992': {
             'slidesPerView': 5
         },
         '1200': {
             'slidesPerView': 6
         }
     }
 }">
    <div class="swiper-wrapper row cols-xl-6 cols-lg-5 cols-md-4 cols-sm-3 cols-2">
        <div class="swiper-slide category category-ellipse">
            <figure class="category-media">
                <a href="shop-banner-sidebar.html">
                    <img src="assets/images/categories/category-4.jpg" alt="Categroy" style="background-color: #5C92C0;" width="190" height="190">
                </a>
            </figure>
            <div class="category-content">
                <h4 class="category-name">
                    <a href="shop-banner-sidebar.html">Sports</a>
                </h4>
            </div>
        </div>
        <div class="swiper-slide category category-ellipse">
            <figure class="category-media">
                <a href="shop-banner-sidebar.html">
                    <img src="assets/images/categories/category-5.jpg" alt="Categroy" style="background-color: #B8BDC1;" width="190" height="190">
                </a>
            </figure>
            <div class="category-content">
                <h4 class="category-name">
                    <a href="shop-banner-sidebar.html">Babies</a>
                </h4>
            </div>
        </div>
        <div class="swiper-slide category category-ellipse">
            <figure class="category-media">
                <a href="shop-banner-sidebar.html">
                    <img src="assets/images/categories/category-6.jpg" alt="Categroy" style="background-color: #99C4CA;" width="190" height="190">
                </a>
            </figure>
            <div class="category-content">
                <h4 class="category-name">
                    <a href="shop-banner-sidebar.html">Sneakers</a>
                </h4>
            </div>
        </div>
        <div class="swiper-slide category category-ellipse">
            <figure class="category-media">
                <a href="shop-banner-sidebar.html">
                    <img src="assets/images/categories/category-7.jpg" alt="Categroy" style="background-color: #4E5B63;" width="190" height="190">
                </a>
            </figure>
            <div class="category-content">
                <h4 class="category-name">
                    <a href="shop-banner-sidebar.html">Cameras</a>
                </h4>
            </div>
        </div>
        <div class="swiper-slide category category-ellipse">
            <figure class="category-media">
                <a href="shop-banner-sidebar.html">
                    <img src="assets/images/categories/category-8.jpg" alt="Categroy" style="background-color: #D3E5EF;" width="190" height="190">
                </a>
            </figure>
            <div class="category-content">
                <h4 class="category-name">
                    <a href="shop-banner-sidebar.html">Games</a>
                </h4>
            </div>
        </div>
        <div class="swiper-slide category category-ellipse">
            <figure class="category-media">
                <a href="shop-banner-sidebar.html">
                    <img src="assets/images/categories/category-9.jpg" alt="Categroy" style="background-color: #65737C;" width="190" height="190">
                </a>
            </figure>
            <div class="category-content">
                <h4 class="category-name">
                    <a href="shop-banner-sidebar.html">Kitchen</a>
                </h4>
            </div>
        </div>
    </div>
    <div class="swiper-pagination"></div>
</div>*@

<div class="page-content mb-8">
    <div class="container">
        <!-- End of Vendor Map -->

        <div class="row gutter-lg" style="padding-top: 26rem;">
            <aside class="sidebar vendor-sidebar sticky-sidebar-wrapper left-sidebar sidebar-fixed">
                <div class="sidebar-overlay"></div>
                <a class="sidebar-close" href="#"><i class="close-icon"></i></a>
                <a href="#" class="sidebar-toggle"><i class="fas fa-chevron-right"></i></a>
                <div class="sidebar-content">
                    <div class="sticky-sidebar">
                        <div class="widget widget-search-form">
                            <div class="widget-body">
                                <form action="#" method="GET" class="input-wrapper input-wrapper-inline">
                                    <input type="text" class="form-control" placeholder="Search ..." autocomplete="off" required="">
                                    <button class="btn btn-search"><i class="w-icon-search"></i></button>
                                </form>
                            </div>
                        </div>
                        <!-- End of Widget -->
                        
                        <div class="widget widget-filter">
                            <h4 class="widget-title">Filter By Category</h4>
                            <div class="widget-body">
                                
                                    <select id="selectBox" onchange="changeFunc();" name="orderby" class="form-control">
                                        <option value="choose" selected="selected">Choose Category ...</option>
                                      @{
                                            foreach (var item in Model.BusinessCategories)
                                            {
                                                <option value="@item.BusinessCategoryId">@item.BusinessCategoryTitleEn</option>
                                            }
                                      }
                                        
                                       
                                    </select>
                               
                            </div>
                        </div>
                        <!-- End of Widget -->
                        <!--Category Parent-->
                        <div id="FilterByChildCategoryID" style="display:none" class="widget widget-filter">
                            <h4 class="widget-title">Filter By Child Category</h4>
                            <div class="widget-body">
                                
                                    <select id="pages" onchange="childchangeFunc();" name="childCategory" class="form-control">
                                       @* <option  value="choose" selected="selected">Choose Category ...</option>*@
                                      


                                    </select>
                               
                        </div>
                        <!--End Categoryparent-->
                        
                        <!-- End of Widget -->
                        
                    </div>

                        <div id="FilterByCityID" style="display:none" class="widget widget-filter">
                            <h4 class="widget-title">Filter By City</h4>
                            <div class="widget-body">

                                <select name="City" id="CityID" class="form-control">
                                    <option value="choose" selected="selected">Choose Location ...</option>
                                    @{
                                        foreach (var item in Model.Cities)
                                        {
                                            <option value="@item.CityId">@item.CityTlEn</option>
                                        }
                                    }


                                </select>


                            </div>
                        </div>

                        <div id="FilterByAreaID" style="display:none" class="widget widget-filter">
                            <h4 class="widget-title">Filter By Area</h4>
                            <div class="widget-body">

                                <select id="AreaId" name="Area" class="form-control">
                                    <option value="choose" selected="selected">Choose Location ...</option>
                                    @{
                                        foreach (var item in Model.Areas)
                                        {
                                            <option value="@item.AreaId">@item.AreaTlEn</option>
                                        }
                                    }
                                    <option value="afghanistan">Afghanistan</option>


                                </select>


                            </div>
                        </div>
                        <!-- End of Sticky Sidebar -->
                        <div id="FilterbtnID" style="display:none" class="btn-wrap show-code-action">
                            <button onclick="GetProducts()" class="btn btn-primary btn-outline">Filter</button>
                        </div>

                        
                </div>
                <!-- End of Sidebar Content -->
            </aside>
            <!-- End of Sidebar -->
            
            <div class="main-content">
                @*<div class="toolbox wcfm-toolbox">
                    <div class="toolbox-left">
                        <form class="select-box toolbox-item">
                            <select name="orderby" class="form-control">
                                <option value="old-new" selected="selected">Sort by newness: old to new</option>
                                <option value="new-old">Sort by newness: new to old</option>
                                <option value="low-high">Sort by average rating: low to high</option>
                                <option value="high-low">Sort by average rating: high to low</option>
                                <option value="old-new">Sort Alphabetical: A to Z</option>
                                <option value="old-new">Sort Alphabetical: Z to A</option>
                            </select>
                        </form>
                    </div>
                    <div class="toolbox-right">
                        <div class="toolbox-item">
                            <label class="showing-info">Showing 1-2 of 2 result</label>
                        </div>
                    </div>
                </div>*@
                <!-- End of Toolbox -->

                <div id="business" class="row cols-sm-2">
                    @{
                        foreach (var item in Model.ClassifiedBusiness)
                        {
                            var fullStarCount = @item.Rating;
                            var emptyStarCount = 5 - @item.Rating;
                            <div class="store-wrap mb-4">
                        <div class="store store-grid store-wcfm">
                            <div class="store-header">
                                <figure class="store-banner">
                                    <img src="~/@item.Mainpic" alt="Vendor" width="400" height="194" style="background-color: #40475E">
                                </figure>
                            </div>
                            <!-- End of Store Header -->
                            <div class="store-content">
                                <h4 class="store-title">
                                    <a href="vendor-dokan-store.html">@item.Title</a>
                                </h4>
                                <div class="ratings-container">

                                            <span>
                                                @for (int i = 0; i < fullStarCount; i++)
                                                {
                                                    <i style="color:#FF9D2E!important" class="fas fa-star"></i>
                                                }

                                                @for (int i = 0; i < emptyStarCount; i++)
                                                {
                                                    <i class="far fa-star"></i>
                                                }
                                            </span>
                                </div>
                                <ul class="seller-info-list list-style-none">
                                    <li class="store-email">
                                        <a href="email:#">
                                            <i class="far fa-envelope"></i>
                                            <span class="__cf_email__" data-cfemail="62150d0e030f101614070c060d105322070f030b0e4c010d0f">@item.Email</span>
                                        </a>
                                    </li>
                                    <li class="store-phone">
                                        <a href="tel:@item.phone">
                                            <i class="w-icon-phone"></i>
                                                    @item.phone
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <!-- End of Store Content -->
                            <div class="store-footer">
                                <figure class="seller-brand">
                                    <img src="~/@item.Logo" alt="Brand" width="80" height="80">
                                </figure>
                                <a href="#" class="btn btn-inquiry btn-rounded btn-icon-left"><i class="far fa-question-circle"></i>Inquiry</a>
                                <a href="#" class="btn btn-rounded btn-visit">Visit</a>
                            </div>
                            <!-- End of Store Footer -->
                        </div>
                        <!-- End of Store -->
                    </div>
                        }
                    }
                   


                   
                </div>
            </div>
            <!-- End of Main Content -->
        </div>
    </div>
</div>


<script>
    let data = [];
    
    function changeFunc() {
        
        var selectBox = document.getElementById("selectBox");
        var selectedValue = selectBox.options[selectBox.selectedIndex].value;
        console.log(selectedValue);
        console.log(typeof (selectedValue));
        var parseselectedValue = parseInt(selectedValue);
        console.log(typeof (parseselectedValue));
        jQuery.ajax({
            type: "GET",
            url: "/StoreList?handler=ChildCategory",
            data: { "parseselectedValue": parseselectedValue },
            contentType: "application/json",
            dataType: "json",
            success: function (response) {
                console.log(response)
                let dataVewItemDetails = "";

                data = [...response.$values];
                console.log(data)
                document.getElementById("FilterByChildCategoryID").style.display="Block"
                document.getElementById("FilterByCityID").style.display="Block"
                document.getElementById("FilterByAreaID").style.display = "Block"
               
                document.getElementById("FilterbtnID").style.display = "Block"
                // Get the select element
                var selectElement = document.getElementById("pages");

                // Clear any existing options
                selectElement.innerHTML = "";

                // Create the default option
                var defaultOption = document.createElement("option");
                defaultOption.value = "choose";
                defaultOption.text = "Choose Category ...";
                defaultOption.selected = true;
                selectElement.appendChild(defaultOption);

                response.$values.forEach(function (category) {
                    var option = document.createElement("option");
                    option.value = category.BusinessCategoryId;
                    option.text = category.BusinessCategoryTitleEn;
                    selectElement.appendChild(option);
                });

             //   dataVewItemDetails += data.map((e) =>
             //       //var categoryName = e.CategoryName
             //       //console.log(categoryName)
             //       //viewPagesName.classList.add (`" ${e.CategoryName}"`)

                    
             //       `
                        
             //<option value="${e.BusinessCategoryId}">${e.BusinessCategoryTitleEn}</option>
                                            


             //                           </select>
             //                       </form>
             //                   </div>

             //                                   `

             //   ).join("")
             //   viewPagesName.innerHTML = dataVewItemDetails;

                //document.getElementById("DeleteCategoryId").value = response.SiteCategoryId
                //$('#deleteRecordModal').modal('show');


            },
            failure: function (response) {
                alert(response);
            }
        });
    }

    function childchangeFunc(){
        var selectBox = document.getElementById("pages");
        var selectedValue = selectBox.options[selectBox.selectedIndex].value;
        console.log(selectedValue);
        console.log(typeof (selectedValue));
        var parseselectedValue = parseInt(selectedValue);
        console.log(typeof (parseselectedValue));
      
    }

    function GetProducts() {

        //let Businessdata = [];
        const viewPagesName = document.querySelector("#business");
        ////Child Category
        var selectBox = document.getElementById("pages");
        var selectedValue = selectBox.options[selectBox.selectedIndex].value;
        console.log(selectedValue);
        console.log(typeof (selectedValue));
        var parseselectedValue = parseInt(selectedValue);
        console.log(typeof (parseselectedValue));
        /////End Child Category
        /// City/////
        var city = document.getElementById("CityID");
        var cityselectedValue = city.options[city.selectedIndex].value;
        console.log(cityselectedValue);
        console.log(typeof (cityselectedValue));
        var parseCityselectedValue = parseInt(cityselectedValue);
        console.log(typeof (parseCityselectedValue));
        /////End City
        ////Area
        var area = document.getElementById("AreaId");
        var areaselectedValue = area.options[area.selectedIndex].value;
        console.log(areaselectedValue);
        console.log(typeof (areaselectedValue));
        var parseAreaselectedValue = parseInt(areaselectedValue);
        console.log(typeof (parseAreaselectedValue));
        ////End Area

        /////Ajax Request
        jQuery.ajax({
            type: "GET",
            url: "/StoreList?handler=BusinessList",
            data: { "parseselectedValue": parseselectedValue, "parseCityselectedValue": parseCityselectedValue, "parseAreaselectedValue": parseAreaselectedValue },
            contentType: "application/json",
            dataType: "json",
            success: function (response) {
                console.log(response)
                let dataVewItemDetails = "";

                //Businessdata = [...response.$values];
                //console.log(Businessdata)
                //console.log(response)
                //let dataVewItemDetails = "";

                
                dataVewItemDetails += response.$values.map((e) =>
                    //var categoryName = e.CategoryName
                    //console.log(categoryName)
                    //viewPagesName.classList.add (`" ${e.CategoryName}"`)


                    `
                             <div class="store-wrap mb-4">
                                <div class="store store-grid store-wcfm">
                                    <div class="store-header">
                                        <figure class="store-banner">
                                                    <img src="${'/' + e.Mainpic}" alt="Vendor" width="400" height="194" style="background-color: #40475E">
                                        </figure>
                                    </div>
                                    <!-- End of Store Header -->
                                    <div class="store-content">
                                        <h4 class="store-title">
                                                <a href="vendor-dokan-store.html">${e.Title}</a>
                                        </h4>
                                        <div class="ratings-container">
                                            <div class="ratings-full">
                                                <span class="ratings" style="width: 100%;"></span>
                                                <span class="tooltiptext tooltip-top"></span>
                                            </div>
                                        </div>
                                        <ul class="seller-info-list list-style-none">
                                            <li class="store-email">
                                                <a href="email:#">
                                                    <i class="far fa-envelope"></i>
                                                        <span class="__cf_email__" data-cfemail="62150d0e030f101614070c060d105322070f030b0e4c010d0f">${e.Email}</span>
                                                </a>
                                            </li>
                                            <li class="store-phone">
                                                    <a href="tel:${e.phone}">
                                                    <i class="w-icon-phone"></i>
                                                        ${e.phone}
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <!-- End of Store Content -->
                                    <div class="store-footer">
                                        <figure class="seller-brand">
                                                    <img src="${'/' + e.Logo}" alt="Brand" width="80" height="80">
                                        </figure>
                                        <a href="#" class="btn btn-inquiry btn-rounded btn-icon-left"><i class="far fa-question-circle"></i>Inquiry</a>
                                        <a href="#" class="btn btn-rounded btn-visit">Visit</a>
                                    </div>
                                    <!-- End of Store Footer -->
                                </div>
                                <!-- End of Store -->
                            </div>

                                                    `

                ).join("")
                viewPagesName.innerHTML = dataVewItemDetails;




            },
            failure: function (response) {
                alert(response);
            }
        });
        /////End Request
    }



</script>